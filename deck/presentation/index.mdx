import { Cite, Appear } from "spectacle"
import { WhiteSlide, DarkSlide, CodeSlide } from "./slides"
import RegularComponent from "./regular-component"

# Taking Flight with URQL

export default CodeSlide

<br />

![urqlbanner](urql-banner.gif)

---

![Formidable](Formidable-Icon.png)

<br />

**@FormidableLabs**

---

export default CodeSlide

| this is fine  |          i'm dying          |
| :-----------: | :-------------------------: |
| ![me](me.png) | ![suffering](suffering.png) |

**@ryan_gilb**

---

## what is urql?

![poll](poll.png)

---

## what is urql?

- **U**niversal **R**eact **Q**uery **L**ibrary
- Lightweight open source GraphQL client
- Created and maintained by Formidable

---

## Agenda

- **origin story (urql pre-v1)**
- present day (urql v1.x.x)
- DEMO

---

## graphql query

export default CodeSlide

```gql
{
  user(id: "1") {
    id
    username
    email
    likedPosts {
      id
      title
      likes
    }
  }
}
```

---

## response

export default CodeSlide

```json
{
  "user": {
    "id": "1",
    "username": "rick",
    "likedPosts": [
      {
        "id": "4",
        "title": "Big candy mountain",
        "likes": 49
      },
      {
        "id": "7",
        "title": "Why candy corn is underrated",
        "likes": 88
      }
    ]
  }
}
```

## What does a GraphQL client do?

export default CodeSlide

- data fetching
- caching
- view layer integration

---

## GraphQL client landscape

export default CodeSlide

<br />

![apollo-v-relay](apollo-v-relay.png)

---

export default CodeSlide

```json
"dependencies": {
    "apollo-cache-inmemory": "^1.1.7",
    "apollo-client": "^2.2.3",
    "apollo-link-context": "^1.0.7",
    "apollo-link-http": "^1.3.3",
    "react-apollo": "^2.0.4",
}
```

---

export default CodeSlide

```javascript
function getApolloClient() {
  const httpLink = new HttpLink({
    uri: "/graphql"
  })

  const authLink = setContext(async (_, { headers }) => {
    const token = await AsyncStorage.getItem("jwt")
    return {
      headers: {
        ...headers,
        authorization: token ? `Bearer ${token}` : ""
      }
    }
  })

  const client = new ApolloClient({
    link: authLink.concat(httpLink),
    cache: new InMemoryCache()
  })

  return client
}
```

---

export default CodeSlide

```javascript
                         yarn add urql
```

---

export default CodeSlide

```js
'import { Provider, createClient } from 'urql';

const token = localStorage.getItem('token');
const client = createClient({
  url: '/graphql',
  fetchOptions: {
    headers: {
      authorization: `Bearer ${token}`
    }
  }
});

'export const App = () => (
  <Provider value={client}>
    {/* ... */}
  </Provider>
);
```

---

## Agenda

- origin story (urql pre-v1)
- **present day (urql v1.x.x)**
- DEMO

---

## urql v1

export default CodeSlide

<table
  style={{ margin: "0 auto", marginTop: "48px", borderCollapse: "collapse" }}
>
  <tbody>
    <tr style={{ textAlign: "left" }}>
      <td style={{ paddingBottom: "16px" }}>✨ Released Feb 2019</td>
    </tr>
    <tr style={{ textAlign: "left" }}>
      <td style={{ paddingBottom: "16px" }}>✅ React Hooks!</td>
    </tr>
    <tr style={{ textAlign: "left" }}>
      <td style={{ paddingBottom: "16px" }}>
        ✅ Custom client behavior via Exchanges!
      </td>
    </tr>
    <tr style={{ textAlign: "left" }}>
      <td>✅ Compact bundle size & compact API surface area!</td>
    </tr>
  </tbody>
</table>

---

## React Hooks

export default CodeSlide

```js
const [{ fetching, error, data }] = useQuery({
  query: `
    {
      me {
        id
        username
      }
    }
  `
})
```

---

## Programmable Core

export default CodeSlide

![exchange](exchange.svg)

---

## Programmable Core

export default CodeSlide

![exchange-chain](exchange-chain.svg)

---

export default WhiteSlide

## Default Exchanges

![default-exchanges](default-exchanges.svg)

---

## Compact Bundle Size

export default CodeSlide

<br />

<table style={{ margin: "0 auto", borderCollapse: "collapse" }}>
  <thead>
    <tr>
      <th style={{ paddingRight: "48px" }}>urql & graphcache</th>
      <th>apollo (& hooks)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style={{ paddingRight: "48px" }}>14.5kb min+gzip</td>
      <td>30.1kb min+gzip</td>
    </tr>
  </tbody>
</table>

---

## Useful resources

export default CodeSlide

<br />

http://bit.ly/32v1x6o

---

## Why urql?

<br />

export default CodeSlide

Simplicity

Customizability

---

# DEMO!!!

export default CodeSlide
